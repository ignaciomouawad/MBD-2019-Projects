# IE - Master in Business Analytics and Big Data
Recommendation Systems

Building a Non Personalized Recommendation Engine

Author: FirstName LastName

========================================================

# Initialization

Import libraries

```{r}
```

Load the critics dataset.

```{r}
library(data.table)
root_path <- "C:/Users/ignac/Desktop/ie/mbd term 2/reccomendation systems/IE-Lab1/Data/"
critics <- read.csv(file.path(root_path, "critics.csv"));

```

# 1) Top 5 Movies, by rating mean
Calculate mean rating for each movie, ordered with the highest rating listed first, and plot the top 5.

**Expected result**:
3.600000, 'The Shawshank Redemption'
3.266667, 'Star Wars IV - A New Hope'
3.222222, 'Blade Runner'
3.166667, 'Groundhog Day'
3.062500, 'The Silence of the Lambs'

```{r fig.width=7, fig.height=6}

movie_ratings <- critics  #create a new dataframe exactly equal to critics so we can edit without affecting critics table
movie_ratings$User <- NULL #to delete col users so we can calculate mean of numeric columns (movies)
mean_ratings <- sort(colMeans(movie_ratings, na.rm = T), decreasing = T) #to get sorted means
mean_ratings[1:5] #to get top 5 
```

# 2) Top 5 Movies, by rating distribution
Calculate the percentage of ratings for each movie that are 4 stars or higher. Order with the highest percentage first, and plot the top 5 movies with more high ratings distribution.

**Expected result**:
0.7000000, 'The Shawshank Redemption'
0.5333333, 'Star Wars IV - A New Hope'
0.5000000, 'Gladiator'
0.4444444, 'Blade Runner'
0.4375000, 'The Silence of the Lambs'

```{r fig.width=7, fig.height=6}

topperc <- sort(apply(movie_ratings,2,function(x) sum(x>=4, na.rm=T)/sum(x>=0, na.rm=T)),decreasing=T) # creates a function to calculate average number of movies rated 4,5 and applies them on all columns, giving a sorted output
topperc[1:5] #top 5 

``` 

# 3) Top 5 Movies, by quantity of ratings
Count the number of ratings for each movie, order the one with most number of ratings first, submit the top 5.
```{r}
j<-as.data.table(critics)
sort(nrow(j)-sapply(j, function(x){sum(is.na(x))}), decreasing = TRUE)[2:6] #subtracting number of rows from number of na in each row. we used a function to count the nas and sapply to apply this function on all columns
#since we used critics table, and col 1 is users, rating the top 5 we used indexinf 2:6
```
**Expected result**:
17, 'Toy Story'
16, 'The Silence of the Lambs'
15, 'Star Wars IV - A New Hope'
14, 'Star Wars VI - Return of the Jedi'
13, 'Independence Day'

```{r fig.width=7, fig.height=6}
```

# 4) People who watched Star Wars IV also watched ...
Calculate movies that most often occur with other movie. For each movie, calculate the percentage of the other movie raters who also rated that movie. Order with the highest percentage first, and submit the top 5. Select "Star.Wars.IV...A.New.Hope" movie by defaut. Use the (x+y)/x method.

Top Occurences:
0.9333333, 'Toy Story'
0.8666667, 'Star Wars: Episode VI - Return of the Jedi'
0.8000000, 'The Silence of the Lambs'
0.7333333, 'Independence Day'
0.6666667, 'Total Recall'

```{r fig.width=7, fig.height=6}

critics_dt <-as.data.table(critics) #a data table of critics
swiv <- critics_dt[is.na(critics$Star.Wars.IV...A.New.Hope)==0] #creates a new dt of all ratings of users who rated Star Wars IV
sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5]
#using sapply with a function that is created to get number of movies rated from users who watched star wars iv, then using (x+y)/x formula. we subtract 1 because the sapply will take into consideration col 1 which includes star wars iv
```


# 5) People who liked Babe also liked ...
Calculate the movies better rated of people who liked a movie. Select the people who liked the movie "Babe" (4 or 5 stars) and provide the top 5 movies they liked most.

**Expected result**:
5.000, 'Pulp.Fiction'
5.000, 'Groundhog.Day'
4.500, 'The.Shawshank.Redemption'
4.333, 'Toy.Story'
4.000, 'Blade.Runner'

```{r fig.width=7, fig.height=6}
babe_table <- critics 
babe_table <- as.data.table(babe_table)[babe_table$Babe==4 | babe_table$Babe == 5] #creates a table for users who rated babe 4 or 5
babe_table <- babe_table[,2:ncol(babe_table)] #to remove Users col
babe_table$Babe <- NULL #to remove babes column to use sapply
x <- sort(sapply(babe_table, function(x)({mean(x, na.rm = T)})), decreasing = T)
x[1:5]
#sapply to calculate mean of columns removing na, and sorting them with indexing to get top 5
```

# 6) MovieLens
Explore a real data set and provide non-personalized ratings. You can use the MovieLens database. You can find MovieLens' dataset here: http://files.grouplens.org/datasets/movielens/ml-10m-README.html