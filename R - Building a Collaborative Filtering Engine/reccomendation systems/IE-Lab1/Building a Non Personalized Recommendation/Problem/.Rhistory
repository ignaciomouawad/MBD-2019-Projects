library(data.table)
library(lsa)
root_path <- "C:/Users/ignac/Desktop/ie/mbd term 2/reccomendation systems/IE-Lab1/Data/"
critics <- read.csv(file.path(root_path, "critics.csv"));
movie_ratings <- critics
movie_ratings$User <- NULL
mean_ratings <- sort(colMeans(movie_ratings, na.rm = T), decreasing = T)
mean_ratings[1:5]
topperc <- sort(apply(movie_ratings,2,function(x) sum(x>=4, na.rm=T)/sum(x>=0, na.rm=T)),decreasing=T)
topperc[1:5]
j<-as.data.table(critics)
sort(nrow(j)-sapply(j, function(x){sum(is.na(x))}), decreasing = TRUE)[2:6]
critics_dt <-as.data.table(critics)
swiv <- critics_dt[is.na(critics$Star.Wars.IV...A.New.Hope)==0]
sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5]
topocc <- function(a){
movietable <- as.data.table(critics)[!is.na(critics[,a])]
sort((nrow(movietable)+(apply(movietable[,grep(a,colnames(movietable)):ncol(movietable)], 2,function(a){sum(!is.na(a))})))/nrow(movietable)-1, decreasing = T)[2:6]
}
topocc("Star.Wars.IV...A.New.Hope")
babetabe <- critics
babetabe <- as.data.table(babetabe)[babetabe$Babe==4 | babetabe$Babe == 5]
babetabe <- babetabe[,2:ncol(babetabe)]
babetabe$Babe <- NULL
x <- sort(sapply(babetabe, function(x)({mean(x, na.rm = T)})), decreasing = T)
x[1:5]
as.matrix(sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5])
critics_dt <-as.data.table(critics)
swiv <- critics_dt[is.na(critics$Star.Wars.IV...A.New.Hope)==0]
print("Top Occurences")
as.matrix(sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5])
critics_dt <-as.data.table(critics)
swiv <- critics_dt[is.na(critics$Star.Wars.IV...A.New.Hope)==0]
print("Top Occurences")
x <- as.matrix(sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5])
colnames(x)<-NULL
x
critics_dt <-as.data.table(critics)
swiv <- critics_dt[is.na(critics$Star.Wars.IV...A.New.Hope)==0]
print("Top Occurences")
x <- as.matrix(sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5])
colnames(x)<-Score
critics_dt <-as.data.table(critics)
swiv <- critics_dt[is.na(critics$Star.Wars.IV...A.New.Hope)==0]
print("Top Occurences")
x <- as.matrix(sort((nrow(swiv)+(apply(swiv[,3:ncol(swiv)], 2,function(x){sum(!is.na(x))})))/nrow(swiv)-1, decreasing = T)[1:5])
colnames(x)<-"Score"
x
topocc <- function(a){
movietable <- as.data.table(critics)[!is.na(critics[,a])]
as.matrix(sort((nrow(movietable)+(apply(movietable[,grep(a,colnames(movietable)):ncol(movietable)], 2,function(a){sum(!is.na(a))})))/nrow(movietable)-1, decreasing = T)[2:6])
}
topocc("Star.Wars.IV...A.New.Hope")
topocc <- function(a){
movietable <- as.data.table(critics)[!is.na(critics[,a])]
x<- as.matrix(sort((nrow(movietable)+(apply(movietable[,grep(a,colnames(movietable)):ncol(movietable)], 2,function(a){sum(!is.na(a))})))/nrow(movietable)-1, decreasing = T)[2:6])
colnames(x)<-"Score"
return(x)
}
topocc("Star.Wars.IV...A.New.Hope")
babetabe <- critics
babetabe <- as.data.table(babetabe)[babetabe$Babe==4 | babetabe$Babe == 5]
babetabe <- babetabe[,2:ncol(babetabe)]
babetabe$Babe <- NULL
x <- sort(sapply(babetabe, function(x)({mean(x, na.rm = T)})), decreasing = T)
as.matrix(x[1:5])
babetabe <- critics
babetabe <- as.data.table(babetabe)[babetabe$Babe==4 | babetabe$Babe == 5]
babetabe <- babetabe[,2:ncol(babetabe)]
babetabe$Babe <- NULL
x <- sort(sapply(babetabe, function(x)({mean(x, na.rm = T)})), decreasing = T)
x<- as.matrix(x[1:5])
colnames(x) <- "Score"
x
topocc <- function(a){
movietable <- as.data.table(critics)[!is.na(critics[,a])]
x<- as.matrix(sort((nrow(movietable)+(apply(movietable[,grep(a,colnames(movietable)):ncol(movietable)], 2,function(a){sum(!is.na(a))})))/nrow(movietable)-1, decreasing = T)[2:6])
colnames(x)<-"Score"
return(x)
}
topocc("Star.Wars.IV...A.New.Hope")
j<-as.data.table(critics)
j <- as.matrix(sort(nrow(j)-sapply(j, function(x){sum(is.na(x))}), decreasing = TRUE)[2:6])
j<-as.data.table(critics)
j <- as.matrix(sort(nrow(j)-sapply(j, function(x){sum(is.na(x))}), decreasing = TRUE)[2:6])
j
j<-as.data.table(critics)
j <- as.matrix(sort(nrow(j)-sapply(j, function(x){sum(is.na(x))}), decreasing = TRUE)[2:6])
colnames(j)<- "count"
j
topperc <- sort(apply(movie_ratings,2,function(x) sum(x>=4, na.rm=T)/sum(x>=0, na.rm=T)),decreasing=T)
topperc<- as.matrix(topperc[1:5])
colnames(topperc)<- "rating distribution"
topperc <- sort(apply(movie_ratings,2,function(x) sum(x>=4, na.rm=T)/sum(x>=0, na.rm=T)),decreasing=T)
topperc<- as.matrix(topperc[1:5])
colnames(topperc)<- "rating distribution"
topperc
movie_ratings <- critics
movie_ratings$User <- NULL
mean_ratings <- sort(colMeans(movie_ratings, na.rm = T), decreasing = T)
mean_ratings <- mean_ratings[1:5]
colnames(mean_ratings)<- "mean rating"
mean_ratings
movie_ratings <- critics
movie_ratings$User <- NULL
mean_ratings <- sort(colMeans(movie_ratings, na.rm = T), decreasing = T)
mean_ratings <- as.matrix(mean_ratings[1:5])
colnames(mean_ratings)<- "mean rating"
mean_ratings
