

formvect <- vector()
sumformvect <- vector()
absvect <- vector()
sumabsvect <- vector()
User.1ratings <- vector()
User.1_avg <- mean(feedback$User.1, na.rm = T)


for (quest in 1:nrow(feedback)) {
  for(user in 1:ncol(feedback)){
    rum <- feedback[quest,user]
    
    ravg <- mean(feedback[,user], na.rm = T)
    
    if(is.na(rum)| identical(feedback$User.1, feedback[,user])){form <- 0}
    else{
      wau <- cor(feedback$User.1,feedback[,user], use = "complete.obs")
      
      form <- (rum - ravg)*wau
      
    }
    print(form)
    formvect[user] <- form
    
    absvect[user] <- (wau) 
    
  }
  sumformvect[user]<- sum(formvect, na.rm = T)
  sumabsvect[user]<- sum(abs(absvect), na.rm = T)
  #print(sumformvect)
  User.1ratings[quest] <- User.1_avg + (sumformvect[quest]/6.928035)
}

User.1ratings
feedback$User.1
head(feedback)
